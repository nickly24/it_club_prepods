{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{IoIosRefreshCircle}from\"react-icons/io\";import axios from'axios';import TableCard from'./TableCard';import AddSchedule from\"./AddTable\";// исправить имя файла, если нужно\nimport{api_main}from'./constants';// путь к вашему файлу constants.js\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const api=\"\".concat(api_main,\"schedules\");export default function Table(){const[data,setData]=useState([]);const[collapsed,setCollapsed]=useState({});const daysOfWeek=[\"Понедельник\",\"Вторник\",\"Среда\",\"Четверг\",\"Пятница\",\"Суббота\",\"Воскресенье\"];const toggleCollapse=day=>{setCollapsed(prevState=>({...prevState,[day]:!prevState[day]}));};const refreshKindergartens=async()=>{try{const response=await axios.get(api);setData(response.data);console.log(response.data);}catch(error){console.error('Error fetching schedules:',error);}};useEffect(()=>{refreshKindergartens();},[]);const sortByTime=(a,b)=>{const timeA=a.time.split(\":\").map(Number);const timeB=b.time.split(\":\").map(Number);return timeA[0]-timeB[0]||timeA[1]-timeB[1];};const handleSave=async updatedSchedule=>{try{await axios.put(\"\".concat(api,\"/\").concat(updatedSchedule.id),updatedSchedule);setData(data.map(item=>item.id===updatedSchedule.id?updatedSchedule:item));}catch(error){console.error('Error updating schedule:',error);}};const handleDelete=async id=>{try{await axios.delete(\"\".concat(api,\"/\").concat(id));setData(data.filter(item=>item.id!==id));}catch(error){console.error('Error deleting schedule:',error);}};const handleScheduleAdded=async newSchedule=>{try{const response=await axios.get(\"\".concat(api,\"/\").concat(newSchedule.filial_id));const filialData=response.data;const updatedSchedule={...newSchedule,name:filialData.name,address:filialData.address,metro:filialData.metro,metro_color:filialData.metro_color};setData([...data,updatedSchedule]);}catch(error){console.error('Error fetching filial data:',error);refreshKindergartens();// fallback to refresh if there's an error\n}};return/*#__PURE__*/_jsxs(\"div\",{className:\"card_main pd20\",children:[/*#__PURE__*/_jsx(AddSchedule,{onScheduleAdded:handleScheduleAdded}),/*#__PURE__*/_jsx(\"div\",{className:\"textright\",children:/*#__PURE__*/_jsx(IoIosRefreshCircle,{onClick:refreshKindergartens,className:\"refresh-icon\"})}),daysOfWeek.map((day,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"card_main pd20 mb15\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"weekday\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleCollapse(day),className:\"cardopen\",children:collapsed[day]?\"+\":\"-\"}),day]}),!collapsed[day]&&/*#__PURE__*/_jsx(\"div\",{className:\"grid3 mt20\",children:data.filter(schedule=>schedule.day_of_week===day).sort(sortByTime).map((schedule,idx)=>/*#__PURE__*/_jsx(TableCard,{schedule:schedule,onSave:handleSave,onDelete:handleDelete},idx))})]},index))]});}","map":{"version":3,"names":["React","useState","useEffect","IoIosRefreshCircle","axios","TableCard","AddSchedule","api_main","jsx","_jsx","jsxs","_jsxs","api","concat","Table","data","setData","collapsed","setCollapsed","daysOfWeek","toggleCollapse","day","prevState","refreshKindergartens","response","get","console","log","error","sortByTime","a","b","timeA","time","split","map","Number","timeB","handleSave","updatedSchedule","put","id","item","handleDelete","delete","filter","handleScheduleAdded","newSchedule","filial_id","filialData","name","address","metro","metro_color","className","children","onScheduleAdded","onClick","index","schedule","day_of_week","sort","idx","onSave","onDelete"],"sources":["/Users/nickly/Desktop/Прога/project7/client/src/modules/Table.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { IoIosRefreshCircle } from \"react-icons/io\";\nimport axios from 'axios';\nimport TableCard from './TableCard';\nimport AddSchedule from \"./AddTable\";  // исправить имя файла, если нужно\n\nimport { api_main } from './constants'; // путь к вашему файлу constants.js\n\nconst api = `${api_main}schedules`;\n\nexport default function Table() {\n  const [data, setData] = useState([]);\n  const [collapsed, setCollapsed] = useState({});\n\n  const daysOfWeek = [\"Понедельник\", \"Вторник\", \"Среда\", \"Четверг\", \"Пятница\", \"Суббота\", \"Воскресенье\"];\n\n  const toggleCollapse = (day) => {\n    setCollapsed(prevState => ({\n      ...prevState,\n      [day]: !prevState[day]\n    }));\n  };\n\n  const refreshKindergartens = async () => {\n    try {\n      const response = await axios.get(api);\n      setData(response.data);\n      console.log(response.data);\n    } catch (error) {\n      console.error('Error fetching schedules:', error);\n    }\n  };\n\n  useEffect(() => {\n    refreshKindergartens();\n  }, []);\n\n  const sortByTime = (a, b) => {\n    const timeA = a.time.split(\":\").map(Number);\n    const timeB = b.time.split(\":\").map(Number);\n    return timeA[0] - timeB[0] || timeA[1] - timeB[1];\n  };\n\n  const handleSave = async (updatedSchedule) => {\n    try {\n      await axios.put(`${api}/${updatedSchedule.id}`, updatedSchedule);\n      setData(data.map(item => item.id === updatedSchedule.id ? updatedSchedule : item));\n    } catch (error) {\n      console.error('Error updating schedule:', error);\n    }\n  };\n\n  const handleDelete = async (id) => {\n    try {\n      await axios.delete(`${api}/${id}`);\n      setData(data.filter(item => item.id !== id));\n    } catch (error) {\n      console.error('Error deleting schedule:', error);\n    }\n  };\n\n  const handleScheduleAdded = async (newSchedule) => {\n    try {\n      const response = await axios.get(`${api}/${newSchedule.filial_id}`);\n      const filialData = response.data;\n\n      const updatedSchedule = {\n        ...newSchedule,\n        name: filialData.name,\n        address: filialData.address,\n        metro: filialData.metro,\n        metro_color: filialData.metro_color,\n      };\n\n      setData([...data, updatedSchedule]);\n    } catch (error) {\n      console.error('Error fetching filial data:', error);\n      refreshKindergartens(); // fallback to refresh if there's an error\n    }\n  };\n\n  return (\n    <div className=\"card_main pd20\">\n      <AddSchedule onScheduleAdded={handleScheduleAdded} />\n      <div className=\"textright\">\n        <IoIosRefreshCircle onClick={refreshKindergartens} className=\"refresh-icon\" />\n      </div>\n      {daysOfWeek.map((day, index) => (\n        <div key={index} className=\"card_main pd20 mb15\">\n          <div className=\"weekday\">\n            <button onClick={() => toggleCollapse(day)} className=\"cardopen\">\n              {collapsed[day] ? \"+\" : \"-\"}\n            </button>\n            {day}\n          </div>\n          {!collapsed[day] && (\n            <div className=\"grid3 mt20\">\n              {data\n                .filter(schedule => schedule.day_of_week === day)\n                .sort(sortByTime)\n                .map((schedule, idx) => (\n                  <TableCard\n                    key={idx}\n                    schedule={schedule}\n                    onSave={handleSave}\n                    onDelete={handleDelete}\n                  />\n                ))}\n            </div>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}